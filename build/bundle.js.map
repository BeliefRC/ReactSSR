{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///./src/Routers.js","webpack:///./src/components/Header.js","webpack:///./src/containers/Home/index.js","webpack:///./src/containers/Home/store/actions.js","webpack:///./src/containers/Home/store/constants.js","webpack:///./src/containers/Home/store/index.js","webpack:///./src/containers/Home/store/reducer.js","webpack:///./src/containers/Login/index.js","webpack:///./src/server/index.js","webpack:///./src/server/utils.js","webpack:///./src/store/index.js","webpack:///external \"axios\"","webpack:///external \"express\"","webpack:///external \"react\"","webpack:///external \"react-dom/server\"","webpack:///external \"react-redux\"","webpack:///external \"react-router-config\"","webpack:///external \"react-router-dom\"","webpack:///external \"redux\"","webpack:///external \"redux-thunk\""],"names":["path","key","component","Home","exact","loadData","Login","Header","Component","mapDispatchToProps","dispatch","getHomeList","connect","state","list","home","newsList","getList","props","map","item","id","title","length","alert","store","a","success","changeList","type","CHANGE_List","axios","get","then","res","data","defaultState","action","app","express","use","static","req","getStore","matchedRoutes","matchRoutes","routes","promises","forEach","route","push","Promise","all","send","render","server","listen","console","log","content","renderToString","JSON","stringify","getState","reducer","combineReducers","homeReducer","createStore","applyMiddleware","thunk","getClientStore","defaultStore","window","context"],"mappings":"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","file":"bundle.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = \"./src/server/index.js\");\n","import React from 'react'\r\nimport Home from './containers/Home'\r\nimport Login from './containers/Login'\r\n\r\nexport default [\r\n  {\r\n    path: '/',\r\n    key:'home',\r\n    component: Home,\r\n    exact: true,\r\n    loadData: Home.loadData\r\n  },\r\n  {\r\n    path: '/login',\r\n    key:'login',\r\n    component: Login,\r\n    exact: true,\r\n    // loadData: Login.loadData()\r\n  },\r\n]\r\n","import React, { Component, Fragment } from 'react'\r\nimport { Link } from 'react-router-dom'\r\n\r\nexport default class Header extends Component {\r\n  render () {\r\n    return <header>\r\n      <Link to='/'>Home</Link>\r\n      <br/>\r\n      <Link to='/login'>Login</Link>\r\n      <hr/>\r\n    </header>\r\n  }\r\n}\r\n//31：53\r\n","import React, { Component, Fragment } from 'react'\r\nimport { connect } from 'react-redux'\r\nimport { getHomeList } from './store/actions'\r\n\r\nconst mapDispatchToProps = dispatch => ({\r\n  getHomeList () {\r\n    dispatch(getHomeList())\r\n  }\r\n})\r\n@connect((state) => ({\r\n    list: state.home.newsList\r\n  }),\r\n  mapDispatchToProps)\r\nexport default class Home extends Component {\r\n  // 服务端渲染时，把store里的数据加载好\r\n  static loadData = (store) => {\r\n    return store.dispatch(getHomeList())\r\n  }\r\n\r\n  componentDidMount () {\r\n    if (!this.props.list.length){\r\n      this.props.getHomeList()\r\n    }\r\n  }\r\n\r\n  getList = () => {\r\n    const {list} = this.props\r\n    return list.map(item => <div key={item.id}>\r\n      {item.title}\r\n    </div>)\r\n  }\r\n\r\n  render () {\r\n    return <div>\r\n      {this.getList()}\r\n      <button onClick={() => {alert('click')}}>click</button>\r\n    </div>\r\n  }\r\n}\r\n\r\nconst a = {\r\n  success: true,\r\n  'data': [{\r\n    id: 1,\r\n    title: 'ECMAScript 6简介'\r\n  },\r\n    {\r\n      id: 2,\r\n      title: 'let 和 const 命令'\r\n    },\r\n    {\r\n      id: 3,\r\n      title: '变量的解构赋值'\r\n    },\r\n    {\r\n      id: 4,\r\n      title: '字符串的扩展'\r\n    },\r\n    {\r\n      id: 5,\r\n      title: '正则的扩展'\r\n    },\r\n  ]\r\n}\r\n","import axios from 'axios'\r\nimport { CHANGE_List } from './constants'\r\n\r\nconst changeList = (list) => ({\r\n  type: CHANGE_List,\r\n  list\r\n})\r\nexport const getHomeList = () => {\r\n  return dispatch => {\r\n    return axios.get('https://www.easy-mock.com/mock/5c6eba8f02694c5c754f57f9/ssr/api/news.json')\r\n      .then(res => {\r\n        const list = res.data.data\r\n        dispatch(changeList(list))\r\n      })\r\n  }\r\n}\r\n","export const CHANGE_List='HOME/CHANGE_List'\r\n","import reducer from './reducer'\r\n\r\nexport { reducer }\r\n","import {CHANGE_List} from './constants'\r\nconst defaultState = {\r\n  newsList: []\r\n}\r\nexport default (state = defaultState, action) => {\r\n  switch (action.type) {\r\n    case CHANGE_List:\r\n      return {\r\n        ...state,\r\n        newsList: action.list\r\n      }\r\n    default:\r\n      return state\r\n  }\r\n}\r\n","import React, { Component, Fragment } from 'react'\r\n\r\nexport default class Login extends Component {\r\n  render () {\r\n    return <Fragment>\r\n      Login\r\n    </Fragment>\r\n  }\r\n}\r\n","import express from 'express'\r\nimport { matchRoutes } from 'react-router-config'\r\nimport { render } from './utils'\r\nimport { getStore } from '../store'\r\nimport routes from '../Routers'\r\n\r\nconst app = express()\r\napp.use(express.static('public'))\r\napp.get('*', (req, res) => {\r\n  const store = getStore()\r\n  const matchedRoutes = matchRoutes(routes, req.path)\r\n  const promises = []\r\n  matchedRoutes.forEach(item => {\r\n    if (item.route.loadData) {\r\n      promises.push(item.route.loadData(store))\r\n    }\r\n  })\r\n  Promise.all(promises)\r\n    .then(() => {\r\n      res.send(render(store, routes, req))\r\n    })\r\n\r\n})\r\nconst server = app.listen(3000, () => {\r\n  console.log(`server start at port 3000`)\r\n})\r\n","import React, { Fragment } from 'react'\r\nimport { renderToString } from 'react-dom/server'\r\nimport { StaticRouter, Route } from 'react-router-dom'\r\nimport { Provider } from 'react-redux'\r\nimport Header from '../components/Header'\r\n\r\nexport const render = (store, routes, req) => {\r\n\r\n  const content = renderToString(\r\n    <Provider store={store}>\r\n      <StaticRouter location={req.path} context={{}}>\r\n        <Fragment>\r\n          <Header/>\r\n          {routes.map(route => (\r\n            <Route {...route} />\r\n          ))}\r\n        </Fragment>\r\n      </StaticRouter>\r\n    </Provider>\r\n  )\r\n  return `<!DOCTYPE html>\r\n<html lang=\"en\">\r\n<head>\r\n    <meta charset=\"UTF-8\">\r\n    <title>ssr</title>\r\n</head>\r\n<body>\r\n    <div id=\"root\">${content}</div>\r\n    <script >\r\n    window.context={\r\n      state:${JSON.stringify(store.getState())}\r\n    }\r\n</script>\r\n    <script src=\"index.js\"></script>\r\n</body>\r\n</html>\r\n`\r\n\r\n}\r\n","import { createStore, applyMiddleware, combineReducers } from 'redux'\r\nimport thunk from 'redux-thunk'\r\nimport { reducer as homeReducer } from '../containers/Home/store'\r\n\r\nconst reducer = combineReducers({\r\n  home: homeReducer\r\n})\r\n\r\nexport const getStore = () => createStore(reducer, applyMiddleware(thunk))\r\nexport const getClientStore = () => {\r\n  const defaultStore = window.context.state\r\n  return createStore(reducer, defaultStore, applyMiddleware(thunk))\r\n}\r\n\r\n\r\n","module.exports = require(\"axios\");","module.exports = require(\"express\");","module.exports = require(\"react\");","module.exports = require(\"react-dom/server\");","module.exports = require(\"react-redux\");","module.exports = require(\"react-router-config\");","module.exports = require(\"react-router-dom\");","module.exports = require(\"redux\");","module.exports = require(\"redux-thunk\");"],"sourceRoot":""}